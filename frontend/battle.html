<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KYNDO - Batalla de Mazos</title>
  <!-- Cache bust for latest UI -->
  <link rel="stylesheet" href="./css/styles.css?v=20260202-4">
</head>
<body style="margin:0; padding:0;">
  <div class="page-shell">
    <header>
      <div class="header-bar">
        <a class="brand-link" href="../index.html">
          <div class="brand-block">
            <h1 class="brand-title">Kindo</h1>
            <div class="brand-subtitle">Kombat</div>
          </div>
        </a>

        <div class="hud-block" aria-label="Estado de batalla">
          <div class="hud-row hud-meta">
            <span>Nivel <span id="battle-hud-level">1</span></span>
            <span>Grado <span id="battle-hud-grade">1</span></span>
          </div>
          <div class="hud-row">
            <span>Game <span id="battle-hud-game">1</span>/<span id="battle-hud-gamesTotal">8</span></span>
            <span>Ronda <span id="battle-hud-round">1</span>/<span id="battle-hud-roundsPerGame">5</span></span>
            <span>Game points <span id="battle-hud-score">0-0-0</span></span>
          </div>
        </div>

        <div class="actions-block">
          <div id="user-info">
            <div class="player-info" id="battle-player">
              <div class="player-avatar">ðŸ‘¤</div>
              <div class="player-name">Jugador</div>
            </div>
            <div class="player-info" id="battle-opponent" style="display: none;">
              <div class="player-avatar">ðŸ‘¤</div>
              <div class="player-name">Oponente</div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <main class="page-main">
      <div id="battleContainer"></div>
    </main>

    <footer>
      <p style="font-size:12px; opacity:.65;">KYNDO - Cognitive Card Game Engine</p>
    </footer>
  </div>

  <script type="module">
    import { DemoBattleController } from './js/battle-controller.js';

    const battleContainer = document.getElementById('battleContainer');
    let currentController = null;

    async function startBattle() {
      battleContainer.innerHTML = '<div style="text-align:center;padding:40px;color:#a0aec0;">Cargando cartas... &#9203;</div>';
      try {
        currentController = new DemoBattleController();
        const battleUI = await currentController.startDemo();
        battleContainer.innerHTML = '';
        battleContainer.appendChild(battleUI);
      } catch (err) {
        console.error('Battle start error:', err);
        battleContainer.innerHTML = `<div style="text-align:center;padding:40px;color:#fc8181;">
          <div style="font-size:32px;margin-bottom:12px;">&#9888;&#65039;</div>
          <div style="font-weight:700;margin-bottom:8px;">Error al cargar el Kombate</div>
          <div style="font-size:13px;opacity:0.7;margin-bottom:16px;">${err.message || 'Verifica que el backend est&#233; corriendo en localhost:4001'}</div>
          <button onclick="location.reload()" style="padding:10px 24px;background:linear-gradient(135deg,#667eea,#764ba2);color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600;">Reintentar</button>
        </div>`;
      }
    }

    startBattle();
  </script>
</body>
</html>

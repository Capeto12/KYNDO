generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

/*
  Minimal schema focused on cards and presentation rules.
*/

model Card {
  id            String   @id @default(uuid())
  objectId      String?
  title         String?
  rarity        String   @default("common")
  metadata      Json?
  assetPath     String?
  thumbnailPath String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  AuditLogs     AuditLog[] @relation("card_audit")
}

model PresentationRule {
  id          String   @id @default(uuid())
  themeId     String?
  rarity      String
  colorTokens Json
  iconUrl     String?
  backUrl     String?
  cssClass    String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Asset {
  id              String   @id @default(uuid())
  themeVersionId  String?
  type            String
  filePath        String
  mimeType        String?
  hash            String?
  createdAt       DateTime @default(now())
}

model AuditLog {
  id         String   @id @default(uuid())
  actorId    String?
  action     String
  targetType String
  targetId   String?
  before     Json?
  after      Json?
  createdAt  DateTime @default(now())

  card       Card?    @relation("card_audit", fields: [targetId], references: [id])
}
